class Budget {
    constructor() {
        this.budeget = document.getElementById("bud_name");
    }

    handledata() {
        let budeget = localStorage.getItem("budget");
        
        let handlexp = JSON.parse(localStorage.getItem("expance"));
        let totalexp;

        if (budeget) {
            document.getElementById("bud_get").innerHTML = budeget;
        }

        if (handlexp) {
            totalexp = handlexp.reduce((acc, v) => acc+v.expamu, 0);            
            document.getElementById("exp_amu").innerHTML = totalexp;
        }

        if (budeget && totalexp) {
            let bal = parseInt(budeget) - totalexp;
            document.getElementById("bala_amu").innerHTML = bal;
        }  
        console.log(totalexp);
    }

    handlebudget() {
        event.preventDefault();

        console.log(this.budeget.value);

        if (this.budeget.value === '') {
            document.getElementById("numErr").innerHTML = "Please Enter Budget";
        } else {
            if (parseInt(this.budeget.value) < 0 || isNaN(this.budeget.value)) {
                document.getElementById("numErr").innerHTML = "Please Enter valid Budget";
            } else{
                document.getElementById("numErr").innerHTML = "";
                const budeget = localStorage.setItem("budget",this.budeget.value);
            }
        }
        this.handledata();
    }
}

class Expance extends Budget {
    constructor() {
        super();
        this.exp_name = document.getElementById("exp_name");
        this.expamu = document.getElementById("amu");
    }

    handleexpance() {
        event.preventDefault();
        let expErr = false;

        if (this.exp_name.value === '') {
            document.getElementById("expErr").innerHTML = "Please Enter Expance Name";
        } else {
            document.getElementById("expErr").innerHTML = "";
        }

        if (this.expamu.value === '') {
            document.getElementById("amuErr").innerHTML = "Please Enter Expance Amount";
             expErr = true;
        } else {
            if (parseInt(this.expamu.value) < 0 || isNaN(this.expamu.value)) {
                document.getElementById("amuErr").innerHTML = "Please Enter Valid Expance Amount";
                expErr = true;
            } else{
                document.getElementById("amuErr").innerHTML = "";
            }
        }

        if (!expErr) {
            let localexp = JSON.parse(localStorage.getItem("expance"));

            console.log(localexp);

            let obj = {
                id : Math.floor(Math.random()*10),
                exp_name : this.exp_name.value,
                expamu :  parseInt(this.expamu.value),
            };
            if (localexp) {
                localexp.push(obj);
                localStorage.setItem("expance",JSON.stringify(localexp));
            } else{
                localStorage.setItem("expance",JSON.stringify([obj]));
            }
        }
        this.handledata();
    }
}

const b = new Budget();
const e = new Expance();
e.handledata();

const budeget = document.getElementById("budgetForm");
budeget.addEventListener("submit",function() {
    b.handlebudget();
})

const expance = document.getElementById("formExpance");
expance.addEventListener("submit",function() {
    e.handleexpance();
})